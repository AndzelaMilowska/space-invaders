(()=>{"use strict";var e,A={756:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAE0lEQVR4nGN0YGxgdGBUYITQDAATeAIpXor/hQAAAABJRU5ErkJggg=="},791:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRF////AAAAVcLTfgAAAAJ0Uk5T/wDltzBKAAAAEklEQVR4nGNMYFzAeACIIfQDACTYBQnp7+WvAAAAAElFTkSuQmCC"},6:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAE0lEQVR4nGN0YFRgdGBsYITQDAAQGAHJbGSyvgAAAABJRU5ErkJggg=="},217:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAEklEQVR4nGNUYHRgbABiCM0AABDYAgkv5jS4AAAAAElFTkSuQmCC"},397:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAEUlEQVR4nGN0YITBB4wMjAwAEngCKZ5t0KsAAAAASUVORK5CYII="},294:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAEklEQVR4nGN0YATBB2CSgZEBABT4AiklfGerAAAAAElFTkSuQmCC"},983:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAFElEQVR4nGN0YHRgfMDoAIYMjAwAFjgCKQPxxykAAAAASUVORK5CYII="},464:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRF////AAAAVcLTfgAAAAJ0Uk5T/wDltzBKAAAAEUlEQVR4nGNkYFwAhw8YHwAAH/gE6fTnXI4AAAAASUVORK5CYII="},233:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAADUlEQVR4nGN0YESGDAAQGAHJKX5HVwAAAABJRU5ErkJggg=="},589:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAEklEQVR4nGN0YHRgPMCYACUZABmYAwl3AMM6AAAAAElFTkSuQmCC"},692:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAADUlEQVR4nGN0YESGDAAQGAHJKX5HVwAAAABJRU5ErkJggg=="},555:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAMAAAAIAQMAAAAGIdc/AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAE0lEQVR4nGNMYDzA6MAIIR0YGQAdGAMJDKzEhQAAAABJRU5ErkJggg=="},430:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAFklEQVR4nGNkaGBk3A9C8ncZ7ffDEQBJgQb9eF93mwAAAABJRU5ErkJggg=="},664:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAIElEQVR4nGNk+sfIIMDINI9R6B0j43pG12RG+aOM9tsAP2sF6r8W2FMAAAAASUVORK5CYII="},155:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAIUlEQVR4nGMU+MLYNJ1RYAMjEwOj9zNGxcWM8hcZzXcDAE8vBr+VhpopAAAAAElFTkSuQmCC"},394:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAHElEQVR4nGPk6GBkkmNkv8nI/xCEgAwmO0ZOdgA6RQSp9B8xPAAAAABJRU5ErkJggg=="},932:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAIElEQVR4nGNkrGdk3svIfpORdzEj/0NG1tmMHByMLDIAPwwEmeGtFtwAAAAASUVORK5CYII="},39:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAIElEQVR4nGNkrGdk3svIfpORdzEj/0NGJjtG1tmMXG4APtwE+W71VQkAAAAASUVORK5CYII="},765:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAIElEQVR4nGNk4WFkkmNkf8nIe5pR/i6j+F1GEQZG5lgAL9cEZVW5+kcAAAAASUVORK5CYII="},614:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAH0lEQVR4nGNk4WEUEmIUv8sou59R/i4j/0tGoAgHAwAwaAQZ+Fh9cAAAAABJRU5ErkJggg=="},881:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAIAQMAAADKuO3UAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAAHUlEQVR4nGNksWFUSmMUYGDkkGBMWAMiheoYVVQAIXgDBRUKd28AAAAASUVORK5CYII="}},t={};function a(e){var n=t[e];if(void 0!==n)return n.exports;var i=t[e]={exports:{}};return A[e](i,i.exports,a),i.exports}class n{canvasElement;canvasContext2D;constructor(e,A){this.canvasElement=document.getElementById(e),this.canvasContext2D=this.canvasElement.getContext("2d"),this.canvasElement.width=A.x,this.canvasElement.height=A.y}get canvas(){return this.canvasElement}get canvasContext(){return this.canvasContext2D}}!function(e){e.StartScreen="startScreen",e.InGame="inGame",e.GameWin="win",e.GameLoose="loose"}(e||(e={}));const i="pixel",s="30px",r="20px",o="#ffffff",c="60px",m={x:1e3,y:750},g={startGame:{coordinates:{x:m.x/2,y:m.y-m.y/4},fontConfig:`${s} ${i}`,fontStyle:o,text:"PRESS ANY KEY TO START"},howToPlayInfo:{coordinates:{x:m.x/2,y:m.y-m.y/6},fontConfig:`${r} ${i}`,fontStyle:o,text:"ATTACK X\n        MOVE ← → "},scoreAdvancesTable:{coordinates:{x:m.x/2,y:m.y/2},fontConfig:`${r} ${i}`,fontStyle:o},title:{coordinates:{x:m.x/2,y:m.y/3},fontConfig:`${c} ${i}`,fontStyle:o,text:"SPACE INVADERS"},gameLoose:{coordinates:{x:m.x/2,y:m.y/2},fontConfig:`${c} ${i}`,fontStyle:o,text:"GAME OVER"},gameWin:{coordinates:{x:m.x/2,y:m.y/3+50},fontConfig:`${c} ${i}`,fontStyle:o,text:"YOU WIN"},backToMenu:{coordinates:{x:m.x/2,y:m.y-m.y/6},fontConfig:`${r} ${i}`,fontStyle:o,text:"PRESS ANY KEY"},highestScore:{coordinates:{x:m.x/2,y:30},fontConfig:`${r} ${i}`,fontStyle:o,text:"HI-SCORE: "},newHighestScore:{coordinates:{x:m.x/2,y:m.y/3+100},fontConfig:`${s} ${i}`,fontStyle:o,text:"NEW RECORD!"}},l={PLAYER_IMGS:[a(430),a(430)],ENEMY_01_IMGS:[a(932),a(39)],ENEMY_02_IMGS:[a(765),a(614)],FIRE_01_IMGS:[a(756),a(791),a(6),a(217)],FIRE_02_IMGS:[a(397),a(294),a(983),a(464)],FIRE_03_IMGS:[a(233),a(589),a(692),a(555)],ENEMY_01_EXPLOSION:[a(881)],PLAYER_EXPLOSION:[a(664),a(155),a(394)]},d={frameStep:{x:0,y:-3},size:{x:7,y:21},baseAnimationFrames:l.FIRE_02_IMGS,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,damage:1,frameSkip:15};let h={size:{x:48,y:24},baseAnimationFrames:l.PLAYER_EXPLOSION,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,frameSkip:15,duration:44};const f={size:{x:48,y:24},frameStep:{x:5,y:0},baseAnimationFrames:l.PLAYER_IMGS,currentBaseAnimationFrame:l.PLAYER_IMGS[0],indexOfCurrentFrame:0,lives:3,fireType:d,fireFrequency:{min:50,max:55},frameSkip:1e3,deathAnimationConfig:h,timeToRespawn:200},S={frameStep:{x:0,y:3},size:{x:7,y:21},baseAnimationFrames:l.FIRE_01_IMGS,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,damage:1,frameSkip:15};let p={size:{x:48,y:24},baseAnimationFrames:l.ENEMY_01_EXPLOSION,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,frameSkip:100,duration:20};const x={size:{x:48,y:24},frameStep:{x:2,y:0},padding:10,lives:1,baseAnimationFrames:l.ENEMY_01_IMGS,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,scorePrice:20,fireType:S,fireFrequency:{min:200,max:3e3},frameSkip:50,deathAnimationConfig:p},y={totalRowsCount:0,enemiesCount:0,columnsCount:11,offsetTop:50,offsetLeft:200,frameStep:{x:12,y:12},frameSkip:50,speedProgression:2,enemiesTable:[{type:x,rowsCount:2},{type:{size:{x:48,y:24},frameStep:{x:2,y:0},padding:10,lives:1,baseAnimationFrames:l.ENEMY_02_IMGS,currentBaseAnimationFrame:"",indexOfCurrentFrame:0,scorePrice:10,fireType:S,fireFrequency:{min:400,max:3e3},frameSkip:50,deathAnimationConfig:p},rowsCount:3}]},w={scoreConfig:{coordinates:{x:8,y:30},fontConfig:`${r} ${i}`,fontStyle:o},playerLives:{coordinates:{x:m.x-180,y:30},fontConfig:`${r} ${i}`,fontStyle:o,icon:l.PLAYER_IMGS[0],iconSize:{x:32,y:16}}};class u{countEnemiesLeftOffset(){return(this.canvasConfig.x-this.enemiesConfig.columnsCount*(x.size.x+x.padding))/2}enemiesConfig=y;canvasConfig=m;playerConfig=f;uiConfig=w}class E{moveBullet(e){e.coordinates.x+=e.type.frameStep.x,e.coordinates.y+=e.type.frameStep.y}spawnBullet(e,A){if(e.bulletCountdown>0||e.lives<=0)return;const t={coordinates:{x:e.coordinates.x+e.type.size.x/2,y:e.coordinates.y},type:e.type.fireType};A.push(t),e.bulletCountdown=this.calculateBulletCountdown(e.type.fireFrequency)}calculateBulletCountdown(e){return Math.floor(Math.random()*(e.max-e.min+1)+e.min)}}class C extends n{drawElement(e){let A=new Image,t=e.type;t.currentBaseAnimationFrame=t.baseAnimationFrames[t.indexOfCurrentFrame],A.src=t.currentBaseAnimationFrame,this.canvasContext.imageSmoothingEnabled=!1,this.canvasContext.drawImage(A,e.coordinates.x,e.coordinates.y,t.size.x,t.size.y)}drawText(e,A,t,a){this.canvasContext.font=t,this.canvasContext.fillStyle=a,this.canvasContext.fillText(e,A.x,A.y)}drawCenteredText(e,A,t,a){this.canvasContext.font=t;let n=this.canvasContext.measureText(e).width,i={x:A.x-n/2,y:A.y};this.drawText(e,i,t,a)}}class R{static detectCollision(e,A,t,a){const n=A.type;if(!(A.lives<1))for(let i=0;i<e.length;i++){if(e[i].coordinates.y<=0||e[i].coordinates.y>=1e3)return void e.splice(i,1);const s=A.coordinates.x,r=s+n.size.x,o=A.coordinates.y,c=o+n.size.y;if(e[i].coordinates.x>=s&&e[i].coordinates.x<=r&&e[i].coordinates.y>=o&&e[i].coordinates.y<=c)return e.splice(i,1),A.lives--,this.explode(t,A),void(a&&a())}}static explode(e,A){e.push({coordinates:{x:A.coordinates.x,y:A.coordinates.y},type:A.type.deathAnimationConfig,animationFrame:0})}}class I{static changeDisplayedImg(e){e.indexOfCurrentFrame=e.indexOfCurrentFrame===e.baseAnimationFrames.length-1?0:e.indexOfCurrentFrame+1}}class k extends E{gameData;config;constructor(e,A){super(),this.gameData=e,this.config=A}runEnemiesActions(){const{enemiesTable:e}=this.gameData,{enemiesConfig:A}=this.config;if(this.gameData.currentFrameIndex%A.frameSkip==0){let t,a;I.changeDisplayedImg(A.enemiesTable[0].type),I.changeDisplayedImg(A.enemiesTable[1].type),A.frameStep.x>0?(t=this.findRightmostEnemy(),a=this.isCanvasTouched(t,!0)):(t=this.findLeftmostEnemy(),a=this.isCanvasTouched(t,!1)),a?this.onCanvasWallTouch():e.coordinates.x=e.coordinates.x+A.frameStep.x}}isCanvasTouched(e,A){const{enemiesConfig:t,canvasConfig:a}=this.config;return A?e.coordinates.x+t.frameStep.x+e.type.size.x>=a.x:e.coordinates.x+t.frameStep.x<=0}onCanvasWallTouch(){const{enemiesTable:e}=this.gameData,{enemiesConfig:A}=this.config;e.coordinates.y=e.coordinates.y-A.frameStep.y,A.frameStep.x=-1*A.frameStep.x,A.frameSkip=A.frameSkip<=10?A.frameSkip:A.frameSkip-A.speedProgression}findLeftmostEnemy(){const{enemies:e}=this.gameData;let A=0,t=0;for(;e[A][t].lives<1;)if(A<e.length-1)A++;else if(A===e.length-1&&t<e[0].length-1)A=0,t++;else if(t===e[e.length-1].length-1)return e[e.length-1][e[0].length-1];return e[A][t]}findRightmostEnemy(){const{enemies:e}=this.gameData;let A=e.length-1,t=e[e.length-1].length-1;for(;e[A][t].lives<=0;)if(A>=1)A--;else if(0===A&&t>0)t--,A=e.length-1;else if(0===t)return e[0][0];return e[A][t]}iterateEnemies(e){for(let A=0;A<this.gameData.enemies.length;A++)for(let t=0;t<this.gameData.enemies[A].length;t++)e(this.gameData.enemies[A][t])}isOnBottom(A){A.coordinates.y<=this.config.canvasConfig.y-this.config.canvasConfig.y/10||(this.gameData.gameStatus=e.GameLoose)}}class G extends R{static detectEnemyCollision(e,A){let{playerShots:t}=e;this.detectCollision(t,A,e.currentExplosions,(()=>{e.killsCount++,A.type.scorePrice&&(e.score=e.score+1e-5*A.type.scorePrice)}))}}class F{endGameMenuSprites;initiateGameEndSprites(e,A,t,a){let n=[];for(let t=0;t<a;t++)n.push({...e}),n.push({...A});const i=e.type.size.x*a+A.type.size.x*a+10*(a-1),s=t.coordinates.x-i/2-e.type.size.x/4,r=t.coordinates.y+e.type.size.y;n[0].coordinates={x:s,y:r};for(let e=1;e<n.length;e++)n[e].coordinates={x:n[e-1].coordinates.x+10+A.type.size.x,y:r};this.endGameMenuSprites=n}listenForAnyKeyClick(e){document.addEventListener("keydown",(function A(t){document.removeEventListener("keydown",A),e()}))}}const D=new u,B=new class extends u{currentFrameIndex=0;gameStatus=e.StartScreen;player={coordinates:{x:(this.canvasConfig.x-this.playerConfig.size.x)/2,y:this.canvasConfig.y-this.playerConfig.size.y-20},lives:this.playerConfig.lives,type:this.playerConfig,timeToRespawn:0};enemies=[];playerShots=[];score=0;killsCount=0;enemyShots=[];enemiesTable={skippedFrameCounter:50,coordinates:{x:0,y:0}};currentExplosions=[];endgameTime=0;highestScore=0},T=new class extends E{isRightKeyPressed;isLeftKeyPressed;constructor(){super(),this.isRightKeyPressed=!1,this.isLeftKeyPressed=!1}detectMovement(){document.addEventListener("keydown",(e=>{"Right"===e.key||"ArrowRight"===e.key?this.isRightKeyPressed=!0:"Left"!==e.key&&"ArrowLeft"!==e.key||(this.isLeftKeyPressed=!0)}),!1),document.addEventListener("keyup",(e=>{"Right"===e.key||"ArrowRight"===e.key?this.isRightKeyPressed=!1:"Left"!==e.key&&"ArrowLeft"!==e.key||(this.isLeftKeyPressed=!1)}),!1)}movePlayer(e,A){let t=A.player,a=e.playerConfig;this.isRightKeyPressed?t.coordinates.x=Math.min(t.coordinates.x+t.type.frameStep.x,e.canvasConfig.x-a.size.x):this.isLeftKeyPressed&&(t.coordinates.x=Math.max(t.coordinates.x-t.type.frameStep.x,0))}playerAttack(e){document.addEventListener("keydown",(A=>{"x"===A.key&&this.spawnBullet(e.player,e.playerShots)}))}},v=new k(B,D),M=new class extends F{gameConfig;gameData;constructor(e,A){super(),this.gameConfig=e,this.gameData=A}isWin(){this.gameConfig.enemiesConfig.enemiesCount===this.gameData.killsCount?this.gameData.gameStatus=e.GameWin:this.gameData.player.lives<1&&(this.gameData.gameStatus=e.GameLoose),this.gameData.gameStatus!==e.GameLoose&&this.gameData.gameStatus!==e.GameWin||this.gameData.endgameTime++}}(D,B),U=new class{config;gameData;player;enemiesActions;constructor(e,A,t,a){this.config=e,this.gameData=A,this.player=t,this.enemiesActions=a}initializeGame(){this.config.enemiesConfig.offsetLeft=this.config.countEnemiesLeftOffset(),this.gameData.enemies=this.initializeEnemies(this.config.enemiesConfig),this.calculateTotalEnemiesNumber(this.config.enemiesConfig),this.player.detectMovement(),this.player.playerAttack(this.gameData)}calculateTotalEnemiesNumber(e){e.enemiesCount=e.columnsCount*e.totalRowsCount}initializeEnemies(e){const{enemiesTable:A}=e;let t=[];for(let a=0;a<A.length;a++){const n=t.length,i=t.length+A[a].rowsCount;for(let s=n;s<i;s++){e.totalRowsCount++,t[s]=[];for(let n=0;n<e.columnsCount;n++)t[s][n]={coordinates:{x:0,y:0},lives:A[a].type.lives,type:A[a].type,bulletCountdown:this.enemiesActions.calculateBulletCountdown(A[a].type.fireFrequency)}}}return t}findHighestScore(){let e=localStorage.getItem("hi-score");e||(e="00000",localStorage.setItem("hi-score",e)),this.gameData.highestScore=+e,g.highestScore.text=g.highestScore.text+this.gameData.highestScore.toFixed(5).substring(2)}}(D,B,T,v),Q=new C("myCanvas",D.canvasConfig),N=new class extends C{drawEnemies(e,A){const{enemies:t,enemiesTable:a}=e;for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++){let i=t[e][n];if(i.lives>0){const t=n*(i.type.size.x+i.type.padding)+A.offsetLeft+a.coordinates.x,s=e*(i.type.size.y+i.type.padding)+A.offsetTop-a.coordinates.y;i.coordinates={x:t,y:s},this.drawElement(i)}}}}("myCanvas",D.canvasConfig),K=new class extends E{drawer;constructor(e){super(),this.drawer=e}renderBullets(e,A){for(let t=0;t<e.length;t++)this.drawer.drawElement(e[t]),this.moveBullet(e[t]),A.currentFrameIndex%e[t].type.frameSkip==0&&I.changeDisplayedImg(e[t].type)}}(Q),b=new class extends C{drawScore(e,A){this.drawText(`Score: ${e.toFixed(5).substring(2)}`,A.coordinates,A.fontConfig,A.fontStyle)}drawPlayerLives(e,A){this.drawText("Lives: ",A.coordinates,A.fontConfig,A.fontStyle);for(let t=0;t<e;t++){let e=new Image;e.src=A.icon,this.canvasContext.drawImage(e,A.coordinates.x+t*A.iconSize.x+70,A.coordinates.y-A.iconSize.y-1,A.iconSize.x,A.iconSize.y)}}drawStartScreenTextElement(e,A){const{text:t,coordinates:a,fontConfig:n,fontStyle:i}=e;this.drawCenteredText(t,a,n,i)}drawScoreAdvancesTable(e,A){const{coordinates:t,fontConfig:a,fontStyle:n}=A;for(let A=0;A<e.length;A++){const i=` = ${e[A].type.scorePrice} PTS`;let s={x:t.x+e[A].type.size.x/2,y:t.y-(A-1)*(e[A].type.size.y+10)+e[A].type.size.y-5};this.drawCenteredText(i,s,a,n);let r=this.canvasContext.measureText(i).width,o={x:t.x-r/2-e[A].type.size.x/2,y:t.y-(A-1)*(e[A].type.size.y+10)};this.drawElement({coordinates:o,type:e[A].type})}}drawSprites(e,A,t){for(let A=0;A<e.length;A++)this.drawElement(e[A]);if(t.currentFrameIndex%A[0].frameSkip==0)for(let e=0;e<A.length;e++)I.changeDisplayedImg(A[e])}}("myCanvas",D.canvasConfig),L=new class{drawer;player;config;gameData;attacksRenderer;constructor(e,A,t,a,n){this.drawer=e,this.player=A,this.config=t,this.gameData=a,this.attacksRenderer=n}renderPlayer(){let{enemyShots:e,player:A,playerShots:t}=this.gameData;A.timeToRespawn>0?A.timeToRespawn--:(A.bulletCountdown--,this.player.movePlayer(this.config,this.gameData),this.drawer.drawElement(A),R.detectCollision(e,A,this.gameData.currentExplosions,(()=>{A.timeToRespawn=A.type.timeToRespawn}))),this.attacksRenderer.renderBullets(t,this.gameData)}}(Q,T,D,B,K),O=new class{drawer;constructor(e){this.drawer=e}renderExplosions(e){for(let A=0;A<e.length;A++){if(e[A].animationFrame++,e[A].animationFrame>=e[A].type.duration)return void e.splice(A,1);this.drawer.drawElement(e[A]),e[A].animationFrame%e[A].type.frameSkip==0&&I.changeDisplayedImg(e[A].type)}}}(Q),z=new class extends k{enemiesDrawer;enemiesActions;collisionDetector;attacksRenderer;constructor(e,A,t,a){super(A,e),this.config=e,this.gameData=A,this.enemiesDrawer=t,this.attacksRenderer=a}renderEnemies(){this.enemiesDrawer.drawEnemies(this.gameData,this.config.enemiesConfig),this.runEnemiesActions(),this.iterateEnemies((e=>{this.isOnBottom(e),e.bulletCountdown--,G.detectEnemyCollision(this.gameData,e),this.spawnBullet(e,this.gameData.enemyShots)})),this.attacksRenderer.renderBullets(this.gameData.enemyShots,this.gameData)}}(D,B,N,K),J=new class extends F{uiDrawer;gameData;uiConfig;constructor(e,A,t){super(),this.uiDrawer=e,this.gameData=A,this.uiConfig=t}renderUI(){this.uiDrawer.drawScore(this.gameData.score,this.uiConfig.scoreConfig),this.uiDrawer.drawPlayerLives(this.gameData.player.lives,this.uiConfig.playerLives)}renderStartScreen(){this.uiDrawer.drawStartScreenTextElement(g.title),this.uiDrawer.drawScoreAdvancesTable(y.enemiesTable,g.scoreAdvancesTable),this.uiDrawer.drawStartScreenTextElement(g.startGame),this.uiDrawer.drawStartScreenTextElement(g.howToPlayInfo),this.uiDrawer.drawStartScreenTextElement(g.highestScore)}renderEndScreen(A){let t=g.gameLoose;if(this.uiDrawer.drawStartScreenTextElement(g.backToMenu),A===e.GameLoose)t=g.gameLoose,this.uiDrawer.drawSprites(this.endGameMenuSprites,[this.gameData.enemies[0][0].type,this.gameData.enemies[this.gameData.enemies.length-1][0].type],this.gameData);else if(A===e.GameWin&&(t=g.gameWin,this.gameData.score>this.gameData.highestScore&&(this.gameData.highestScore=this.gameData.score,localStorage.setItem("hi-score",`${this.gameData.score.toFixed(5)}`)),this.gameData.score>=this.gameData.highestScore)){this.uiDrawer.drawStartScreenTextElement(g.newHighestScore);let e={...g.newHighestScore};e.text=`${this.gameData.score.toFixed(5).substring(2)}`,e.coordinates={...g.newHighestScore.coordinates},e.coordinates.y=g.newHighestScore.coordinates.y+30,this.uiDrawer.drawStartScreenTextElement(e)}this.uiDrawer.drawStartScreenTextElement(t)}}(b,B,D.uiConfig),P=new class extends n{interval;config;gameInit;gameData;gameplayActions;playerRenderer;enemiesRenderer;uiRenderer;explosionsRenderer;constructor(e,A,t,a,n,i,s,r,o){super(e,A.canvasConfig),this.config=A,this.gameInit=n,this.playerRenderer=a,this.enemiesRenderer=i,this.gameplayActions=s,this.uiRenderer=r,this.gameData=t,this.explosionsRenderer=o}renderGame(){this.gameData.gameStatus===e.InGame&&(this.gameInit.initializeGame(),this.interval=setInterval((()=>{this.canvasContext.clearRect(0,0,this.config.canvasConfig.x,this.config.canvasConfig.y),this.playerRenderer.renderPlayer(),this.enemiesRenderer.renderEnemies(),this.explosionsRenderer.renderExplosions(this.gameData.currentExplosions),this.uiRenderer.renderUI(),this.gameplayActions.isWin(),this.gameData.currentFrameIndex+=1,this.gameData.endgameTime>=50&&(clearInterval(this.interval),this.renderApplication())}),10))}renderStartScreen(){this.uiRenderer.listenForAnyKeyClick((()=>{this.gameData.gameStatus=e.InGame,clearInterval(this.interval),this.renderApplication()})),this.interval=setInterval((()=>{this.canvasContext.clearRect(0,0,this.config.canvasConfig.x,this.config.canvasConfig.y),this.uiRenderer.renderStartScreen()}),10)}renderEndScreen(A){let t="";A===e.GameLoose?(t=g.gameLoose.text,this.uiRenderer.initiateGameEndSprites(this.gameData.enemies[0][0],this.gameData.enemies[this.gameData.enemies.length-1][0],g.gameLoose,3)):A===e.GameWin&&(t=g.gameWin.text),this.uiRenderer.listenForAnyKeyClick((()=>{this.gameData.gameStatus=e.StartScreen,clearInterval(this.interval),document.location.reload()})),this.interval=setInterval((()=>{this.canvasContext.clearRect(0,0,this.config.canvasConfig.x,this.config.canvasConfig.y),this.uiRenderer.renderEndScreen(this.gameData.gameStatus),this.gameData.currentFrameIndex++}),10)}renderApplication(){this.gameInit.findHighestScore(),this.gameData.gameStatus===e.StartScreen&&this.renderStartScreen(),this.gameData.gameStatus===e.InGame&&this.renderGame(),this.gameData.gameStatus!==e.GameLoose&&this.gameData.gameStatus!==e.GameWin||this.renderEndScreen(this.gameData.gameStatus)}}("myCanvas",D,B,L,U,z,M,J,O);P.renderApplication()})();
//# sourceMappingURL=mylib.js.map